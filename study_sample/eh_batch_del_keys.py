import requests
import json

key_set_url = 'https://xxx.yyyy.com/hhh/app/taskqueue/keymap'
del_key_url = 'https://xxx.yyyy.com/hhh/app/taskqueue/deleteKey'
token = 'xxxxxxxxx'


class HttpHelper:
    # 声明私有成员变量
    __url = 'http://www.baidu.com/app/abc'
    __token = 'xxxyyyzzz'

    def __init__(self):
        pass

    def post(self, url, data, token):
        header = {
            "Content-Type": "application/json",
            "X-OS-KERNEL-TOKEN": token
        }
        # 使fiddler可以抓包.
        # proxies = {
        #     "http": "http://10.10.25.12:8888",
        #     "https": "http://10.10.25.12:8888",
        # }
        # res = requests.post(url=url, data=json.dumps(data), headers=header, proxies=proxies)
        res = requests.post(url=url, data=json.dumps(data), headers=header)
        print(res.text)
        return res

    def getUrl(self):
        return self.__url

    def getToken(self):
        return self.__token


httpKit = HttpHelper()
data = {
}
print(data)


def main(keyPattern):
    keySetUrl = key_set_url + '?key=' + keyPattern + '*'
    res = httpKit.post(keySetUrl, data, token)
    # print(res)
    # print(res.content.decode('utf-8'))
    r'''
    {"code":0,"success":true,"message":"","result":{"EHR_RESULT_IMPORT_EMPLOYEENO:GT000178":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002752":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002755":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002756":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT009948":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT057233":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056026":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT008974":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT006311":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056824":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056706":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT000170":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056707":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT010372":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT057186":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT057185":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002767":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT057066":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT007774":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT008181":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056935":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056816":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002659":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002652":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT007029":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002655":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002656":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002657":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT008353":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT008111":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT007384":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002770":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT007026":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056950 ":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056802":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT010608":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT010729":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056803":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056804":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056806":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT010568":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002945":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT004849":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002704":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002705":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002706":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002708":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT009617":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002662":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT010390":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT004726":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056230":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056473":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002944":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT007837":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002823":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056595":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT010278":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056597":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056994":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT005013":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056511":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056875":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002660":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056635":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002661":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT010712":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002717":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002673":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002675":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT009505":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002677":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002679":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT003361":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056741":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056742":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT010582":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056743":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT003363":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002670":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056624":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056228":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT000492":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT000096":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056627":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056628":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT008373":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT009583":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT006470":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT009580":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT008426":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002720":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT000944":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT057144":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT057022":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056452":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT057145":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056058":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002680":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT057029":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT003890":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056611":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056579":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT007454":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002683":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT055008":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056616":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT000260":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002737":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT003707":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT008319":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002731":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002735":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT057016":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT057015":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT009765":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056970 ":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT008273":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT010769":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT008272":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002749":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT000566":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT000168":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT000045":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT000166":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT001771":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT009539":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056272":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002744":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT057122":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002745":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT007518":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT002746":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT009653":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT055342":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056951":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056038":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056159":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056558":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT010514":"1","EHR_RESULT_IMPORT_EMPLOYEENO:GT056838":"1"},"timestamp":1628062838680}
    '''

    r'''
    {"code":0,"success":true,"message":"EHR_RESULT_IMPORT_EMPLOYEENO:GT056838","timestamp":1628062952337}
    '''
    resDict = json.loads(res.content.decode('utf-8'))
    print('code:', resDict['code'])
    if resDict['code'] == 0:
        result = resDict['result']
        # print('result:', resDict['result'])
        if result:
            for key in result:
                print('try to delete ', key, ' , please take a break!')
                delKeyUrl = del_key_url + '?key=' + key
                r = httpKit.post(delKeyUrl, data, token)
                rDict = json.loads(r.content.decode('utf-8'))
                if rDict['code'] == 0 and rDict['success']:
                    print('Congratulations, ', rDict['message'], '  was deleted successfully!!')

        elif not result:
            print('result is empty!!')


# def test():
#     delKeyUrl = del_key_url + '?key=EHR_RESULT_IMPORT_EMPLOYEENO:GT002759';
#     r = httpKit.post(delKeyUrl, data, token)
#     print(r.content.decode("utf-8"))
#     rDict = json.loads(r.content.decode('utf-8'))
#     if rDict['code'] == 0 and rDict['success']:
#         print('Congratulations, ',rDict['message'],'  was deleted successfully!!');
#
# test();

main('EHR_RESULT_IMPORT_EMPLOYEENO')
